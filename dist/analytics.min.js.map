{"version":3,"sourceRoot":"src/analytics.js","sources":["src/analytics.js"],"names":["analytics","init","let","accountID","appName","userID","sessionID","postIntervalSeconds","granularitySec","analyticsURL","postURL","serverConfig","DEFAULT_GRANULARITY_IN_SECONDS","DEFAULT_RETRY_TIME_IN_SECONDS","DEFAULT_POST_INTERVAL_SECONDS","USERID_LOCAL_STORAGE_KEY","POST_LARGE_DATA_THRESHOLD_BYTES","currentAnalyticsEvent","IS_NODE_ENV","window","DEFAULT_BASE_URL","granularityTimer","postTimer","currentQuantisedTime","disabled","debugMode","debugLog","args","console","log","Error","_createAnalyticsEvent","schemaVersion","uuid","unixTimestampUTC","Date","numEventsTotal","events","_validateCurrentState","_setupIDs","localUserID","localStorage","getItem","crypto","randomUUID","setItem","_getOrCreateUserID","localSessionID","sessionStorage","Math","random","toString","substr","_getOrCreateSessionID","_retryPost","eventToSend","backoffCount","setTimeout","_postCurrentAnalyticsEvent","textToSend","_resetGranularityTimer","JSON","stringify","length","warn","fetch","method","headers","Content-Type","body","then","res","status","error","catch","debugError","disable","clearInterval","setInterval","_setupTimers","async","_initFromRemoteConfig","postIntervalSecondsInit","granularitySecInit","Promise","resolve","reject","configURL","serverResponse","json","err","initSession","accountIDInit","appNameInit","analyticsURLInit","debug","replace","getCurrentAnalyticsEvent","parse","event","eventType","eventCategory","subCategory","eventCount","eventValue","_validateEvent","category","count","value","_ensureAnalyticsEventExists","time","valueCount","timeArray","modificationIndex","_updateExistingAnalyticsEvent","index","newValue","storedValueIsCount","newValueCount","storedValueObject","push","getAppConfig"],"mappings":"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"}