{"version":3,"sourceRoot":"src/analytics.js","sources":["src/analytics.js"],"names":["let","accountID","appName","userID","sessionID","postIntervalSeconds","granularitySec","analyticsURL","postURL","serverConfig","DEFAULT_GRANULARITY_IN_SECONDS","DEFAULT_RETRY_TIME_IN_SECONDS","DEFAULT_POST_INTERVAL_SECONDS","USERID_LOCAL_STORAGE_KEY","POST_LARGE_DATA_THRESHOLD_BYTES","currentAnalyticsEvent","IS_NODE_ENV","window","DEFAULT_BASE_URL","granularityTimer","postTimer","currentQuantisedTime","disabled","debugMode","debugLog","args","console","log","debugError","error","Error","_createAnalyticsEvent","schemaVersion","uuid","unixTimestampUTC","Date","numEventsTotal","events","_validateCurrentState","getCurrentAnalyticsEvent","JSON","parse","stringify","_getOrCreateUserID","localUserID","localStorage","getItem","crypto","randomUUID","setItem","_getOrCreateSessionID","localSessionID","sessionStorage","Math","random","toString","substr","_setupIDs","_retryPost","eventToSend","backoffCount","setTimeout","_postCurrentAnalyticsEvent","textToSend","_resetGranularityTimer","length","warn","fetch","method","headers","Content-Type","body","then","res","status","catch","disable","clearInterval","setInterval","_setupTimers","async","_getServerConfig","Promise","resolve","reject","configURL","serverResponse","json","err","getAppConfig","_initFromRemoteConfig","postIntervalSecondsInit","granularitySecInit","_stripTrailingSlash","url","replace","initSession","accountIDInit","appNameInit","analyticsURLInit","debug","_ensureAnalyticsEventExists","eventType","category","subCategory","time","valueCount","_validateEvent","count","value","_updateExistingAnalyticsEvent","index","newValue","storedValueIsCount","newValueCount","storedValueObject","analyticsEvent","eventCategory","eventCount","eventValue","timeArray","push"],"mappings":"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"}