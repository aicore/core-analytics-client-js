{"version":3,"sourceRoot":"src/analytics.js","sources":["src/analytics.js"],"names":["let","accountID","appName","userID","sessionID","postIntervalSeconds","granularitySec","analyticsURL","postURL","serverConfig","DEFAULT_GRANULARITY_IN_SECONDS","DEFAULT_RETRY_TIME_IN_SECONDS","DEFAULT_POST_INTERVAL_SECONDS","USERID_LOCAL_STORAGE_KEY","POST_LARGE_DATA_THRESHOLD_BYTES","currentAnalyticsEvent","IS_NODE_ENV","window","DEFAULT_BASE_URL","granularityTimer","postTimer","currentQuantisedTime","Error","_createAnalyticsEvent","schemaVersion","uuid","unixTimestampUTC","Date","numEventsTotal","events","_validateCurrentState","getCurrentAnalyticsEvent","JSON","parse","stringify","_getOrCreateUserID","localUserID","localStorage","getItem","crypto","randomUUID","setItem","_getOrCreateSessionID","localSessionID","sessionStorage","Math","random","toString","substr","_setupIDs","_retryPost","eventToSend","backoffCount","console","log","setTimeout","_postCurrentAnalyticsEvent","textToSend","_resetGranularityTimer","length","warn","fetch","method","headers","Content-Type","body","then","res","status","error","catch","clearInterval","setInterval","_setupTimers","async","_getServerConfig","Promise","resolve","reject","configURL","serverResponse","json","err","getAppConfig","_initFromRemoteConfig","postIntervalSecondsInit","granularitySecInit","_stripTrailingSlash","url","replace","initSession","accountIDInit","appNameInit","analyticsURLInit","_ensureAnalyticsEventExists","eventType","category","subCategory","time","valueCount","_validateEvent","count","value","_updateExistingAnalyticsEvent","index","newValue","storedValueIsCount","newValueCount","storedValueObject","analyticsEvent","eventCategory","eventCount","eventValue","timeArray","push"],"mappings":"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"}