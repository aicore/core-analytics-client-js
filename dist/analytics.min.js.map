{"version":3,"sourceRoot":"src/analytics.js","sources":["src/analytics.js"],"names":["let","accountID","appName","userID","sessionID","postIntervalSeconds","granularitySec","analyticsURL","postURL","serverConfig","DEFAULT_GRANULARITY_IN_SECONDS","DEFAULT_RETRY_TIME_IN_SECONDS","DEFAULT_POST_INTERVAL_SECONDS","USERID_LOCAL_STORAGE_KEY","POST_LARGE_DATA_THRESHOLD_BYTES","currentAnalyticsEvent","IS_NODE_ENV","window","DEFAULT_BASE_URL","granularityTimer","postTimer","currentQuantisedTime","disabled","Error","_createAnalyticsEvent","schemaVersion","uuid","unixTimestampUTC","Date","numEventsTotal","events","_validateCurrentState","getCurrentAnalyticsEvent","JSON","parse","stringify","_getOrCreateUserID","localUserID","localStorage","getItem","crypto","randomUUID","setItem","_getOrCreateSessionID","localSessionID","sessionStorage","Math","random","toString","substr","_setupIDs","_retryPost","eventToSend","backoffCount","console","log","setTimeout","_postCurrentAnalyticsEvent","textToSend","_resetGranularityTimer","length","warn","fetch","method","headers","Content-Type","body","then","res","status","error","catch","disable","clearInterval","setInterval","_setupTimers","async","_getServerConfig","Promise","resolve","reject","configURL","serverResponse","json","err","getAppConfig","_initFromRemoteConfig","postIntervalSecondsInit","granularitySecInit","_stripTrailingSlash","url","replace","initSession","accountIDInit","appNameInit","analyticsURLInit","_ensureAnalyticsEventExists","eventType","category","subCategory","time","valueCount","_validateEvent","count","value","_updateExistingAnalyticsEvent","index","newValue","storedValueIsCount","newValueCount","storedValueObject","analyticsEvent","eventCategory","eventCount","eventValue","timeArray","push"],"mappings":"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"}