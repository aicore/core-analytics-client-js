{"version":3,"sourceRoot":"src/analytics.js","sources":["src/analytics.js"],"names":["let","accountID","appName","userID","sessionID","postIntervalSeconds","granularitySec","analyticsURL","postURL","serverConfig","DEFAULT_GRANULARITY_IN_SECONDS","DEFAULT_RETRY_TIME_IN_SECONDS","DEFAULT_POST_INTERVAL_SECONDS","USERID_LOCAL_STORAGE_KEY","POST_LARGE_DATA_THRESHOLD_BYTES","currentAnalyticsEvent","IS_NODE_ENV","window","DEFAULT_BASE_URL","granularityTimer","postTimer","currentQuantisedTime","disabled","Error","_createAnalyticsEvent","schemaVersion","uuid","unixTimestampUTC","Date","numEventsTotal","events","_validateCurrentState","getCurrentAnalyticsEvent","JSON","parse","stringify","_getOrCreateUserID","localUserID","localStorage","getItem","crypto","randomUUID","setItem","_getOrCreateSessionID","localSessionID","sessionStorage","Math","random","toString","substr","_setupIDs","_retryPost","eventToSend","backoffCount","console","log","setTimeout","_postCurrentAnalyticsEvent","textToSend","_resetGranularityTimer","length","warn","fetch","method","headers","Content-Type","body","then","res","status","error","catch","clearInterval","setInterval","_setupTimers","async","_getServerConfig","Promise","resolve","reject","configURL","serverResponse","json","err","getAppConfig","_initFromRemoteConfig","postIntervalSecondsInit","granularitySecInit","_stripTrailingSlash","url","replace","initSession","accountIDInit","appNameInit","analyticsURLInit","_ensureAnalyticsEventExists","eventType","category","subCategory","time","valueCount","_validateEvent","count","value","_updateExistingAnalyticsEvent","index","newValue","storedValueIsCount","newValueCount","storedValueObject","analyticsEvent","eventCategory","eventCount","eventValue","timeArray","push"],"mappings":"AAKAA,IAAIC,UAAWC,QAASC,OAAQC,UAAWC,oBAAqBC,eAAgBC,aAAcC,QAASC,aACvG,MAAMC,+BAAiC,EACjCC,8BAAgC,GAChCC,8BAAgC,IAChCC,yBAA2B,0BAC3BC,gCAAkC,IACxCd,IAAIe,sBAAwB,KAC5B,MAAMC,YAAiC,oBAAXC,OAC5BjB,IAAIkB,iBAAmB,4BAEnBC,iBACAC,UACAC,qBAAuB,EACvBC,UAAW,EAIf,GAAGN,YACC,MAAM,IAAIO,MAAM,+CAGpB,SAASC,wBACL,MAAO,CACHC,cAAe,EACfxB,UAAWA,UACXC,QAASA,QACTwB,KAAMvB,OACNC,UAAWA,UACXuB,kBAAmB,IAAIC,KACvBC,eAAgB,EAChBC,OAAQ,IAIhB,SAASC,wBACL,IAAIhB,sBACA,MAAM,IAAIQ,MAAM,4DAIxB,SAASS,2BAGL,OAFAD,wBAEOE,KAAKC,MAAMD,KAAKE,UAAUpB,wBAGrC,SAASqB,qBACLpC,IAAIqC,EAAcC,aAAaC,QAAQ1B,0BAKvC,OAJIwB,IACAA,EAAcG,OAAOC,aACrBH,aAAaI,QAAQ7B,yBAA0BwB,IAE5CA,EAGX,SAASM,wBACL3C,IAAI4C,EAAiBC,eAAeN,QAAQ1B,0BAK5C,OAJI+B,IACAA,EAAiBE,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,IACtDJ,eAAeH,QAAQ7B,yBAA0B+B,IAE9CA,EAGX,SAASM,YACL/C,OAASiC,qBACThC,UAAYuC,wBAGhB,SAASQ,WAAWC,GAChBA,EAAYC,cAAgBD,EAAYC,cAAgB,GAAK,EAC7DC,QAAQC,2DACJ5C,8BAAgCyC,EAAYC,mBAChDG,WAAW,KACPC,2BAA2BL,IACI,IAAhCzC,8BAAuCyC,EAAYC,cAG1D,SAASI,2BAA2BL,GAChC,IAYIM,EAZDpC,WAGC8B,IACAA,EAAcrC,sBACdM,qBAAuB,EACvBsC,yBACA5C,sBAAwBS,yBAEM,IAA/B4B,EAAYvB,kBAGX6B,EAAazB,KAAKE,UAAUiB,IAClBQ,OAAS9C,iCACnBwC,QAAQO,gEAAgEH,EAAWE;2EAGvF3C,OAAO6C,MAAMtD,QAAS,CAClBuD,OAAQ,OACRC,QAAS,CAACC,eAAgB,oBAC1BC,KAAMR,IACPS,KAAKC,IACc,MAAfA,EAAIC,SAGW,MAAfD,EAAIC,OACHlB,WAAWC,GAEXE,QAAQgB,MAAM,+GAGnBC,MAAMH,IACLd,QAAQgB,MAAMF,GACdjB,WAAWC,OAInB,SAASO,uBAAuBrC,GACzBH,mBACCqD,cAAcrD,kBACdA,iBAAmB,MAEpBG,IAGHH,iBAAmBsD,YAAY,KAC3BpD,sBAA8Cf,gBAChC,IAAfA,iBAGP,SAASoE,aAAapD,GAClBqC,uBAAuBrC,GACpBF,YACCoD,cAAcpD,WACdA,UAAY,MAEbE,IAGHF,UAAYqD,YAAYhB,2BAAgD,IAApBpD,sBAGxDsE,eAAeC,mBACX,OAAO,IAAIC,QAAQ,CAACC,EAASC,KACzB/E,IAAIgF,EAAYzE,yCAA0CN,qBAAqBC,SAC/Ee,OAAO6C,MAAMkB,GAAWb,KAAWC,MAAAA,IAC/B,OAAQA,EAAIC,QACZ,KAAK,IACDrE,IAAIiF,QAAuBb,EAAIc,OAE/B,YADAJ,EAAQG,GAEZ,KAAK,IACDF,EAAO,iDAAkDX,GACzD,MACJ,QACIW,EAAO,mFAAoFX,MAEhGG,MAAMY,IACLJ,EAAO,mFAAoFI,OASvG,SAASC,eACL,MAAO,CACHnF,UAAAA,UAAWC,QAAAA,QAASoB,SAAAA,SACpBI,KAAMvB,OAAQC,UAAAA,UACdC,oBAAAA,oBAAqBC,eAAAA,eAAgBC,aAAAA,aAAcE,aAAAA,cAI3DkE,eAAeU,sBAAsBC,EAAyBC,IAC1D9E,mBAAqBmE,sBACD,KAEhBvE,oBAAsBiF,GAClB7E,aAAsC,yBAAKG,8BAC/CN,eAAiBiF,GAAsB9E,aAAiC,oBAAKC,+BAE7EH,aAAeE,aAA+B,kBAAKF,cAAgBW,iBAEnEwD,aADApD,UAAwC,IAA7Bb,aAAuB,UAElC6C,QAAQC,oDAAoDjC,kBAAkBf;8BACxDF,wCAAwCC,oBAItE,SAASkF,oBAAoBC,GACzB,OAAOA,EAAIC,QAAQ,MAAO,IAc9B,SAASC,YAAYC,EAAeC,EAAaC,EAAkBR,EAAyBC,GACxF,IAAIK,IAAkBC,EAClB,MAAM,IAAItE,MAAM,6CAEpBhB,aAAeuF,EAAkBN,oBAAoBM,GAAoB5E,iBACzEjB,UAAY2F,EACZ1F,QAAU2F,EACVxF,oBAAsBiF,GAA2B1E,8BACjDN,eAAiBiF,GAAsB7E,+BACvCF,QAAUD,aAAe,UACzB2C,YACAnC,sBAAwBS,wBACxBkD,eACAW,sBAAsBC,EAAyBC,GAGnD,SAASQ,4BAA4BC,EAAWC,EAAUC,GACtDlG,IAAI8B,EAASf,sBAAsBe,OACnCA,EAAOkE,GAAalE,EAAOkE,IAAc,GACzClE,EAAOkE,GAAWC,GAAYnE,EAAOkE,GAAWC,IAAa,GAC7DnE,EAAOkE,GAAWC,GAAUC,GAAepE,EAAOkE,GAAWC,GAAUC,IAAgB,CACnFC,KAAM,GACNC,WAAY,IAIpB,SAASC,eAAeL,EAAWC,EAAUC,EAAaI,EAAOC,GAE7D,GADAxE,yBACIiE,IAAcC,IAAaC,EAC3B,MAAM,IAAI3E,MAAM,gDAEpB,GAAoB,iBAAX,GAAuB+E,EAAO,EACnC,MAAM,IAAI/E,MAAM,iBAEpB,GAAoB,iBAAX,EACL,MAAM,IAAIA,MAAM,iBAIxB,SAASiF,8BAA8BC,EAAOT,EAAWC,EAAUC,EAAaI,EAAOI,GACnF1G,IAAI8B,EAASf,sBAAsBe,OACnC,IAAM6E,EAA+F,iBAAnE7E,EAAOkE,GAAWC,GAAUC,GAAyB,WAAEO,GACzF,GAAGE,GAAmC,IAAbD,EACrB5E,EAAOkE,GAAWC,GAAUC,GAAyB,WAAEO,IAAUH,OAC9D,GAAGK,GAAmC,IAAbD,EAAe,CAC3C1G,IAAI4G,EAAgB,GACpBA,EAAcF,GAAYJ,EAC1BM,EAAc,GAAK9E,EAAOkE,GAAWC,GAAUC,GAAyB,WAAEO,GAC1E3E,EAAOkE,GAAWC,GAAUC,GAAyB,WAAEO,GAASG,OAC7D,IAAID,EAAmB,CAC1B3G,IAAI6G,EAAoB/E,EAAOkE,GAAWC,GAAUC,GAAyB,WAAEO,GAC/EI,EAAkBH,IAAaG,EAAkBH,IAAa,GAAKJ,EAEvEvF,sBAAsBc,gBAAkB,EAY5C,SAASiF,eAAed,EAAWe,EAAeb,EAAac,EAAW,EAAGC,EAAW,GACpF,IAAG3F,SAAH,CAGA+E,eAAeL,EAAWe,EAAeb,EAAac,EAAYC,GAClElB,4BAA4BC,EAAWe,EAAeb,GACtDlG,IAAI8B,EAASf,sBAAsBe,OACnC9B,IAAIkH,EAAYpF,EAAOkE,GAAWe,GAAeb,GAAmB,KAEpE,IADgC,EAAjBgB,EAAUtD,OAAUsD,EAAUA,EAAUtD,OAAO,GAAK,QACnDvC,qBAAhB,CAEI,GADAS,EAAOkE,GAAWe,GAAeb,GAAmB,KAAEiB,KAAK9F,sBAC3C,IAAb4F,EACCnF,EAAOkE,GAAWe,GAAeb,GAAyB,WAAEiB,KAAKH,OAC9D,CACHhH,IAAIoG,EAAa,GACjBA,EAAWa,GAAcD,EACzBlF,EAAOkE,GAAWe,GAAeb,GAAyB,WAAEiB,KAAKf,GAErErF,sBAAsBc,gBAAkB,OAI5C2E,8BADwB1E,EAAOkE,GAAWe,GAAeb,GAAyB,WAAEtC,OAAQ,EAC3CoC,EAAWe,EAAeb,EAAac,EAAYC,WAIpGtB,YACA3D,yBACA8E,eACA1B"}